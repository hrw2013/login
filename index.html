<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login / Signup</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h2 id="form-title">Sign Up</h2>
  <form id="signup-form">
    <input id="s-name" placeholder="Full name" required />
    <input id="s-email" type="email" placeholder="Email" required />
    <input id="s-pass" type="password" placeholder="Password" required />
    <button type="submit">Sign Up</button>
  </form>

  <form id="login-form" style="display:none">
    <input id="l-email" type="email" placeholder="Email" required />
    <input id="l-pass" type="password" placeholder="Password" required />
    <button type="submit">Login</button>
  </form>

  <div class="small" id="switch-form">Already have an account? Login</div>
</div>

<script type="module">
import { signup, login } from './main.js';

const $ = id => document.getElementById(id);
$('switch-form').onclick = () => {
  const isSignup = $('signup-form').style.display !== 'none';
  $('signup-form').style.display = isSignup ? 'none' : 'block';
  $('login-form').style.display = isSignup ? 'block' : 'none';
  $('form-title').innerText = isSignup ? 'Login' : 'Sign Up';
};

$('signup-form').onsubmit = async e => {
  e.preventDefault();
  try {
    await signup($('s-name').value, $('s-email').value, $('s-pass').value);
    alert("Account created!");
  } catch (err) {
    alert(err.message);
  }
};

$('login-form').onsubmit = async e => {
  e.preventDefault();
  try {
    await login($('l-email').value, $('l-pass').value);
  } catch (err) {
    alert(err.message);
  }
};
</script>
</body>
</html>
